<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Mode Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/style.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@23,400,0,0&icon_names=edit_square,menu">
</head>
<body data-bs-theme="dark">
    <div class="d-flex">
		<button class="btn d-sm-none" style="width: 20px;" type="button" data-bs-toggle="offcanvas" data-bs-backdrop="false" data-bs-target="#offcanvasResponsive" aria-controls="offcanvasResponsive">
			<span class="material-symbols-outlined position-relative top-0">
				menu
			</span>
		</button>
		<nav class="offcanvas-sm offcanvas-start bg-body p-3" style="width: 170px; height: 100vh;" tabindex="-1" id="offcanvasResponsive" aria-labelledby="offcanvasResponsiveLabel">
            <div class="offcanvas-body-sm">
				<h2 class="offcanvas-title mb-4"><a href="/">Product Tracker</a></h2>
				<form method="POST" action="{{ url_for('add_product')}}">
					<div class="form-group">
						<label for="name">Product Name</label>
						<input type="text" class="form-control" id="name" name="name" required>
					</div>
					<div class="form-group">
						<label for="category">Category</label>
						<input name="category" class="form-control" list="datalistOptions" id="exampleDataList">
						<datalist id="datalistOptions">
							{% for category in categories %}
								<option value="{{ category.name }}">
							{% endfor %}
						</select>
					</div>
					<div class="form-group">
						<label for="price">Price</label>
						<input type="number" class="form-control" id="price" name="price" required step="0.01" min="0" placeholder="R$0.00">
					</div>
					<div class="form-group">
						<label for="date">Purchase Date</label>
						<input type="date" class="form-control" id="date" name="date" required>
					</div>
					<div class="form-group mt-2">
						<button type="submit" class="btn btn-primary">Add Product</button>
					</div>
				</form>
			</div>
            <hr>
		</nav>

		<div class="text-center mx-auto p-1 pt-5" style="width: 335px;">
			<div class="container-sm text-start pb-4" style="height: 250px;">
				{% if selected_product %}
					<h2 class="pb-4 text-center">Product Details</h2>
					<h4>{{ selected_product.name.capitalize() }}</h3>
					<p>Category: {{ selected_product.category }}</p>
					<p>Price: {{ brl(selected_product.price) }}</p>
					<p>Average Days Between Purchases: {{ avg_days }} days</p>
				{% else %}
					<div class="text-center">
						<h2>Product Details</h2>
						<p>Select a product to see details.</p>
					</div>
				{% endif %}
			</div>

			<div class="mt-4 mx-auto" style="width: 300px;">
				<h4>Product History</h4>
				<ul id="product-list" class="list-group">
					{% if products %}
						{% for product in products %}
							<li class="list-group-item text-start pe-3 pb-2">
								<div class="d-flex justify-content-between">
									<div>
										<a href="{{ url_for('product', id=product.hist_id) }}">Name: {{ product.name }}</a>
										<span class="ms-4">{{ date_format(product.t_date) }}</span>
										<div class="d-flex align-content-end justify-content-start">
											<span>Category: {{ product.category }}</span>, <span>Price: {{ brl(product.price) }}</span>
										</div>
									</div>
									<span>
										<button class="btn p-1" onclick="editProduct('{{ product.id }}')"><span class="material-symbols-outlined">
											edit_square
											</span></button>
									</span>
								</div>
							</li>
						{% endfor %}
					{% else %}
							<li>No Products</li>
					{% endif %}
				</ul>
			</div>
		</div>
    </div>
	
  	<script>
      	function editProduct(id) {
          	// Logic to edit product
      	}
	</script>
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>